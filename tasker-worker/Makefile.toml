# =============================================================================
# tasker-worker - cargo-make Task Definitions
# =============================================================================
#
# Core Rust foundation for all worker implementations.
# Provides FFI bindings for Ruby, Python, and TypeScript workers.
#
# Quick Start:
#   cargo make check    # Run all quality checks
#   cargo make test     # Run tests
#   cargo make run      # Run as standalone service
#
# =============================================================================

extend = "../cargo-make/base-tasks.toml"

[config]
default_to_workspace = false

[env]
CRATE_NAME = "tasker-worker"

# =============================================================================
# Main Tasks
# =============================================================================

[tasks.default]
alias = "check"

[tasks.check]
description = "Run quality checks"
dependencies = ["format-check", "lint", "test"]

[tasks.format-check]
extend = "base-rust-format"

[tasks.format-fix]
extend = "base-rust-format-fix"

[tasks.lint]
extend = "base-rust-lint"

[tasks.lint-fix]
extend = "base-rust-lint-fix"

[tasks.test]
extend = "base-rust-test"
description = "Run tasker-worker tests"
args = ["nextest", "run", "-p", "${CRATE_NAME}", "--all-features"]

[tasks.fix]
description = "Fix all fixable issues"
dependencies = ["format-fix", "lint-fix"]

[tasks.clean]
description = "Clean build artifacts"
command = "cargo"
args = ["clean", "-p", "${CRATE_NAME}"]

# =============================================================================
# Service Tasks
# =============================================================================

[tasks.run]
description = "Run the worker service"
command = "cargo"
args = ["run", "-p", "${CRATE_NAME}", "--all-features"]

[tasks.run-release]
description = "Run the worker service (release)"
command = "cargo"
args = ["run", "-p", "${CRATE_NAME}", "--all-features", "--release"]
