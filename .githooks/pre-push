#!/bin/bash
# Pre-push hook for comprehensive testing
# Runs full test suite before pushing to remote

set -e

echo "ğŸš€ Running pre-push hooks..."

# Check if cargo is available
if ! command -v cargo &> /dev/null; then
    echo "âŒ Error: cargo is not available. Please install Rust."
    exit 1
fi

echo "ğŸ§ª Running full test suite..."
if ! cargo test --all-features; then
    echo "âŒ Tests failed. Please fix failing tests before pushing."
    exit 1
fi
echo "âœ… All tests passed"

echo "ğŸ“š Checking documentation builds..."
if ! cargo doc --no-deps --document-private-items; then
    echo "âŒ Documentation build failed. Please fix documentation issues."
    exit 1
fi
echo "âœ… Documentation builds successfully"

echo "ğŸ” Running clippy with all features..."
if ! cargo clippy --all-targets --all-features -- -D warnings; then
    echo "âŒ Clippy found issues. Please fix before pushing."
    exit 1
fi
echo "âœ… Clippy checks passed"

echo "ğŸ‰ All pre-push checks passed! Safe to push."