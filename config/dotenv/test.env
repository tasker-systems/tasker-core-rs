# Test environment - standard single-database setup (port 5432)
# Sources: base.env
#
# Usage:
#   cargo make setup-env          # Creates .env from this file
#   cargo make setup-env-split    # Creates .env with split-db overrides

# Database (single database with PGMQ extension)
DATABASE_URL=postgresql://tasker:tasker@localhost:5432/tasker_rust_test
TEST_DATABASE_URL=postgresql://tasker:tasker@localhost:5432/tasker_rust_test

# Messaging Backend Selection (TAS-133)
# Valid values: pgmq (default), rabbitmq
# - pgmq: PostgreSQL Message Queue (single-dependency deployment)
# - rabbitmq: AMQP broker (higher throughput, separate infrastructure)
# For CI matrix testing, override this per job
TASKER_MESSAGING_BACKEND=rabbitmq

# RabbitMQ (TAS-133d - optional messaging backend)
# Matches docker/docker-compose.test.yml rabbitmq service
RABBITMQ_URL=amqp://tasker:tasker@localhost:5672/%2F

# Redis Cache (TAS-156)
REDIS_URL=redis://localhost:6379

# Config path (pre-merged config file - workers may override)
TASKER_CONFIG_PATH=${WORKSPACE_PATH}/config/tasker/complete-test.toml

# Template path (default - workers override this)
TASKER_TEMPLATE_PATH=${WORKSPACE_PATH}/config/tasks

# Web API Configuration
WEB_API_ENABLED=true
WEB_API_TLS_ENABLED=false
WEB_API_TLS_CERT_PATH=${WORKSPACE_PATH}/tests/web/certs/server.crt
WEB_API_TLS_KEY_PATH=${WORKSPACE_PATH}/tests/web/certs/server.key

# Authentication Configuration
WEB_AUTH_ENABLED=true
WEB_JWT_ISSUER=tasker-core-test
WEB_JWT_AUDIENCE=tasker-api-test
WEB_JWT_TOKEN_EXPIRY_HOURS=1

# JWT Keys (for test authentication)
JWT_PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----MIIEowIBAAKCAQEAxAh25l4WV5ibwXaIAETRchkQhVP/OymplWglG+GHM1j2fFdwsBR/jGGfdebsmDSC26/CB4CIQOCOf7YCjZsAbxLioK5R2lAE3AoE9VQRKouwzqpUcylXUswbXdPd1AJMrjaVDOzo27KI8v4/+SiyfgJsBJCLu4owiClKqD7iLHL2sxWKlTcqUy+puCH8u0wfdNM1O0YqQAbD6RhnDPcHY58/f/UD+AHIrCConFDuo1HFrEU0TieJ9BMpx4QM+r7/niLzvx8OfuV3g4OZfWA86fCQ38ACdj/BXJhnCIy3w6GqJiaU+BO6ZBWrYqy1FM4O7O+xvVizQDmwRVDQrxk8PQIDAQABAoIBADuK3qKGPX8JyXVvzUtXm85uMohsxP9xXiMVaQAY9nnwMZ3+6SlycHNxS4ACTibE/GJB9ktVDQ23p1C/NfNQ+0bBk7h+ejo3R+KV4H+rszMbDu8W6WO5UN7DRCSxr5UvxZ680XUFmIzyo4o7E69YXy7LCYgxZ1/lT2xsLlMAFq6tC9/nRx10ZfP5cYBN0gbBNav7fzcEwGvvcfwsxpoVeLR7fjicNjSQ1m6Lovn48rCiTC2xA3OkJBvKbp4rmO9zczxHBYWZBjDI8/Wus/MF3WmzFdNMo07a2xytszjLDvwr/P/ZVhq82Nhcr8xKRlCaGOIPGBcyBKNnGTmr1mL2KTkCgYEA96gRUPBLV9clR3acm0ViNDpGX7L6CIg6tnTI99fmdt+e6+zlfnO46uRVXREpHR+DCV1CC2vjai10zZzjSRCHBdP0GWcf97G9/wsW32hCuN4xE9PMBf1Ttm/oAU80gN7tDsutcsdYRCdIrSWuHlppByTlRWWwg9lCoHq4KYXtIGcCgYEAyqMqnQUzYqUzpZiypS0iKjrEP0pCUEOQ69eOsqLq7LnBYN7ugtuEN6GmL52fxam1G2y0Yzxy406Sf1hONnZXUhfUwVXHBS9eF5jtackPnvSeVyEQX9AdHlmOHNmypuRbzaPMkp2LjJlgUf+mNDtG1zfmsennkEZG9+maHkoqR7sCgYBOqjr926YC+9rijUGHbI2aC1ypLz+OkD8eD5B6cUDKR5PCWtg2x2lYazjWPAo0Lvs/cTj2ScnNwyyT1x626aIJ7t5dZ01XL0Uriwkz43k2IZWzN5ZZ3LLHg1pNeCw0NxtTlMy+ZaWa2GOUZCCfkZZE56pP1dIwv0UTloeC4QCGRwKBgQCGaEAFssNotQdS2bv1D8DPnfc5u7nMn2Rq6qm+F44XwwZfiL9PkOdcNx6SCs1FQNHeBPaJtDjISP+m9B28xjYZP7FhI9JEwCx7Hnarai+wUbUNOeMwikwmK2S2AjgbtvClr/YrcdB0S++1tAq8Lm1Ip82fSPTNn6/HFO2jFbKBrQKBgFDfovReI7rcF1iw90u6inVE+hCXlAfCbD96r3kM/xMJ0t4Udztxj5q0VMAGThAmTYrnD4r7Lst+5YRvTY8DXcKbSYKgJ7R8JyR8ujr+x6r1kxZs+fgcrI0EfygqICvOwkUlBuCwmDdDHcDxp4RgXkob2u3fj6kfpcd/nsV6EjVk-----END RSA PRIVATE KEY-----"
JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxAh25l4WV5ibwXaIAETRchkQhVP/OymplWglG+GHM1j2fFdwsBR/jGGfdebsmDSC26/CB4CIQOCOf7YCjZsAbxLioK5R2lAE3AoE9VQRKouwzqpUcylXUswbXdPd1AJMrjaVDOzo27KI8v4/+SiyfgJsBJCLu4owiClKqD7iLHL2sxWKlTcqUy+puCH8u0wfdNM1O0YqQAbD6RhnDPcHY58/f/UD+AHIrCConFDuo1HFrEU0TieJ9BMpx4QM+r7/niLzvx8OfuV3g4OZfWA86fCQ38ACdj/BXJhnCIy3w6GqJiaU+BO6ZBWrYqy1FM4O7O+xvVizQDmwRVDQrxk8PQIDAQAB-----END PUBLIC KEY-----"
API_KEY="ff3083e54e01ad76ffc3f791359c1ed92b347bcd613af94f88f0bf4991eaa168"

# CORS Configuration
WEB_CORS_ENABLED=true
WEB_CORS_ALLOWED_ORIGINS=http://localhost:3000,https://localhost:3000

# Rate Limiting Configuration
WEB_RATE_LIMITING_ENABLED=false
WEB_RATE_LIMITING_REQUESTS_PER_MINUTE=100

# Circuit Breaker Configuration
WEB_CIRCUIT_BREAKER_ENABLED=true

# Resource Monitoring Configuration
WEB_RESOURCE_MONITORING_ENABLED=true
WEB_POOL_USAGE_WARNING_THRESHOLD=0.75
WEB_POOL_USAGE_CRITICAL_THRESHOLD=0.90
