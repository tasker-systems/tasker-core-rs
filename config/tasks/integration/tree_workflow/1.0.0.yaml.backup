# TaskTemplate Configuration
# 
# This TaskTemplate uses the new self-describing structure for workflow configuration.
# Compatible with both Ruby and Rust parsers.
#
# Template Structure:
# - Self-describing with complete metadata
# - Callable-based handlers (not class-based)
# - Environment-specific overrides
# - Comprehensive retry and timeout configuration
#
---
---
name: tree_workflow
namespace_name: integration
version: 1.0.0
description: Tree workflow for integration testing with complex multi-level dependencies
metadata:
  author: TaskerCore Migration Tool
  tags:
  - namespace:integration
  - pattern:complex
  - dependencies:complex
  - environments:configured
  - migrated:handler-configuration
  documentation_url:
  created_at: '2025-08-17T20:18:41Z'
  updated_at: '2025-08-17T20:18:41Z'
task_handler:
  callable: IntegrationTest::TreeWorkflowHandler
  initialization: {}
system_dependencies:
  primary: test_system
  secondary: []
domain_events: []
input_schema:
  type: object
  properties:
    workflow_type:
      type: string
      enum:
      - tree
    test:
      type: string
steps:
- name: root
  description: Root node of the tree workflow
  handler:
    callable: IntegrationTest::StepHandler::TreeRootHandler
    initialization:
      action: initialize_tree
      branches:
      - a
      - b
      test_mode: true
  system_dependency:
  dependencies: []
  retry:
    retryable: true
    limit: 3
    backoff: exponential
    backoff_base_ms: 1000
    max_backoff_ms: 30000
  timeout_seconds: 30
  publishes_events: []
- name: level1_a
  description: First level branch A
  handler:
    callable: IntegrationTest::StepHandler::TreeLevel1AHandler
    initialization:
      action: process_level1_a
      branch: a
      test_mode: true
  system_dependency:
  dependencies:
  - root
  retry:
    retryable: true
    limit: 3
    backoff: exponential
    backoff_base_ms: 1000
    max_backoff_ms: 30000
  timeout_seconds: 30
  publishes_events: []
- name: level1_b
  description: First level branch B
  handler:
    callable: IntegrationTest::StepHandler::TreeLevel1BHandler
    initialization:
      action: process_level1_b
      branch: b
      test_mode: true
  system_dependency:
  dependencies:
  - root
  retry:
    retryable: true
    limit: 3
    backoff: exponential
    backoff_base_ms: 1000
    max_backoff_ms: 30000
  timeout_seconds: 30
  publishes_events: []
- name: level2_a1
  description: Second level branch A1
  handler:
    callable: IntegrationTest::StepHandler::TreeLevel2A1Handler
    initialization:
      action: process_level2_a1
      branch_path: a.a1
      test_mode: true
  system_dependency:
  dependencies:
  - level1_a
  retry:
    retryable: true
    limit: 3
    backoff: exponential
    backoff_base_ms: 1000
    max_backoff_ms: 30000
  timeout_seconds: 30
  publishes_events: []
- name: level2_a2
  description: Second level branch A2
  handler:
    callable: IntegrationTest::StepHandler::TreeLevel2A2Handler
    initialization:
      action: process_level2_a2
      branch_path: a.a2
      test_mode: true
  system_dependency:
  dependencies:
  - level1_a
  retry:
    retryable: true
    limit: 3
    backoff: exponential
    backoff_base_ms: 1000
    max_backoff_ms: 30000
  timeout_seconds: 30
  publishes_events: []
- name: level2_b1
  description: Second level branch B1
  handler:
    callable: IntegrationTest::StepHandler::TreeLevel2B1Handler
    initialization:
      action: process_level2_b1
      branch_path: b.b1
      test_mode: true
  system_dependency:
  dependencies:
  - level1_b
  retry:
    retryable: true
    limit: 3
    backoff: exponential
    backoff_base_ms: 1000
    max_backoff_ms: 30000
  timeout_seconds: 30
  publishes_events: []
- name: final
  description: Final convergence node
  handler:
    callable: IntegrationTest::StepHandler::TreeFinalHandler
    initialization:
      action: merge_tree_results
      expected_branches:
      - a.a1
      - a.a2
      - b.b1
      test_mode: true
  system_dependency:
  dependencies:
  - level2_a1
  - level2_a2
  - level2_b1
  retry:
    retryable: true
    limit: 3
    backoff: exponential
    backoff_base_ms: 1000
    max_backoff_ms: 30000
  timeout_seconds: 60
  publishes_events: []
environments:
  test:
    task_handler:
    steps:
    - name: root
      handler:
        initialization:
          debug_mode: true
          timeout_ms: 2000
      timeout_seconds:
      retry:
    - name: level1_a
      handler:
        initialization:
          debug_mode: true
          timeout_ms: 2000
      timeout_seconds:
      retry:
    - name: level1_b
      handler:
        initialization:
          debug_mode: true
          timeout_ms: 2000
      timeout_seconds:
      retry:
    - name: level2_a1
      handler:
        initialization:
          debug_mode: true
          timeout_ms: 2000
      timeout_seconds:
      retry:
    - name: level2_a2
      handler:
        initialization:
          debug_mode: true
          timeout_ms: 2000
      timeout_seconds:
      retry:
    - name: level2_b1
      handler:
        initialization:
          debug_mode: true
          timeout_ms: 2000
      timeout_seconds:
      retry:
    - name: final
      handler:
        initialization:
          debug_mode: true
          timeout_ms: 5000
      timeout_seconds:
      retry:
loaded_from: "/Users/petetaylor/projects/tasker-systems/tasker-core-rs/config/tasks/integration/tree_workflow/1.0.0.yaml"
