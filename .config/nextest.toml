[profile.default]
retries = 0
leak-timeout = { period = "500ms", result = "fail" }
fail-fast = false

# Environment variables for E2E tests with Docker services
[[profile.default.overrides]]
filter = 'test(e2e::)'

[profile.ci]
# CI-specific settings
fail-fast = false
slow-timeout = { period = "60s", terminate-after = 2 }
# Limit parallelism to avoid database connection pool exhaustion
# Each test may create a SystemContext with ~20 connections
# With postgres max_connections=500 and 3 services running, limit to 4 threads
# Total usage: 3 services (~95) + 4 test threads (~80) = ~175 connections
test-threads = 4
status-level = "pass"
final-status-level = "slow"

# Environment variables for E2E tests with Docker services
[[profile.ci.overrides]]
filter = 'test(e2e::)'

# Archive settings for test result uploads
[profile.ci.junit]
path = "target/nextest/ci/junit.xml"

[profile.local]
# Local development settings
fail-fast = true
status-level = "retry"

# Environment variables for E2E tests with Docker services
[[profile.local.overrides]]
filter = 'test(e2e::)'
